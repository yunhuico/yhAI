{"paragraphs":[{"title":"Load Dependencies","text":"%dep\nz.load(\"org.apache.commons:commons-csv:1.2\")\nz.load(\"org.apache.spark:spark-streaming-kafka_2.10:1.5.2\")\nz.load(\"com.typesafe.play:play-json_2.10:2.4.6\")\n","dateUpdated":"Jun 21, 2016 1:05:01 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466471040262_-1739278581","id":"20160621-010400_1279820293","result":{"code":"SUCCESS","type":"TEXT","msg":"res0: org.apache.zeppelin.spark.dep.Dependency = org.apache.zeppelin.spark.dep.Dependency@2724aa96\n"},"dateCreated":"Jun 21, 2016 1:04:00 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:50","dateFinished":"Jun 21, 2016 1:05:23 AM","dateStarted":"Jun 21, 2016 1:05:01 AM"},{"title":"Spark Streaming","text":"import java.text.{SimpleDateFormat, ParseException}\nimport java.util.Date\n\nimport org.apache.spark.{SparkConf}\nimport org.apache.spark.streaming.kafka.{KafkaUtils}\nimport org.apache.spark.streaming.{StreamingContext, Seconds}\n\nimport play.api.libs.json._\n\nval ssc = new StreamingContext(sc, Seconds(2))\nval msgStream = KafkaUtils.createStream(ssc, \"master.mesos:2181\", \"zeppelin-consumer-group\", Map(\"tweets\" -> 1)).map(_._2)\n\nval tweetStream = msgStream.map(tweetString => {\n        val tweet = Json.parse(tweetString)\n        ((tweet \\ \"handle\").as[String], (tweet \\ \"content\").as[String], (tweet \\ \"created_at\").as[String])\n    })\ntweetStream.print()\n            \ntweetStream.window(Seconds(3600))\n    .foreachRDD(rdd => rdd.toDF(\"handle\", \"content\", \"created_at\").registerTempTable(\"tweets\"))\n                                   \n                                        \n            \nssc.start()","dateUpdated":"Jun 21, 2016 1:05:01 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"tableHide":false,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466471040265_-1741971823","id":"20160621-010400_1521674791","result":{"code":"SUCCESS","type":"TEXT","msg":"import java.text.{SimpleDateFormat, ParseException}\nimport java.util.Date\nimport org.apache.spark.SparkConf\nimport org.apache.spark.streaming.kafka.KafkaUtils\nimport org.apache.spark.streaming.{StreamingContext, Seconds}\nimport play.api.libs.json._\nssc: org.apache.spark.streaming.StreamingContext = org.apache.spark.streaming.StreamingContext@2a5eea9e\nmsgStream: org.apache.spark.streaming.dstream.DStream[String] = org.apache.spark.streaming.dstream.MappedDStream@6174b268\ntweetStream: org.apache.spark.streaming.dstream.DStream[(String, String, String)] = org.apache.spark.streaming.dstream.MappedDStream@5829bc27\n"},"dateCreated":"Jun 21, 2016 1:04:00 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:51","dateFinished":"Jun 21, 2016 1:05:40 AM","dateStarted":"Jun 21, 2016 1:05:03 AM"},{"title":"Top tweeters","text":"%sql select handle, count(*) as count from tweets\n    group by handle\n    order by count desc","dateUpdated":"Jun 21, 2016 1:06:36 AM","config":{"colWidth":12,"graph":{"mode":"table","height":560,"optionOpen":false,"keys":[{"name":"handle","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"handle","index":0,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql","editorHide":false,"tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466471040265_-1741971823","id":"20160621-010400_496312336","result":{"code":"SUCCESS","type":"TABLE","msg":"handle\tcount\nchao\t1\n","comment":"","msgTable":[[{"key":"count","value":"chao"},{"key":"count","value":"1"}]],"columnNames":[{"name":"handle","index":0,"aggr":"sum"},{"name":"count","index":1,"aggr":"sum"}],"rows":[["chao","1"]]},"dateCreated":"Jun 21, 2016 1:04:00 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:52","dateFinished":"Jun 21, 2016 1:06:37 AM","dateStarted":"Jun 21, 2016 1:06:36 AM","focus":true},{"dateUpdated":"Jun 21, 2016 1:05:02 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1466471040265_-1741971823","id":"20160621-010400_50680901","result":{"code":"SUCCESS","type":"TEXT"},"dateCreated":"Jun 21, 2016 1:04:00 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:53","dateFinished":"Jun 21, 2016 1:05:41 AM","dateStarted":"Jun 21, 2016 1:05:41 AM"}],"name":"tweeter","id":"2BR53PGSP","angularObjects":{"2BPX3S1UX":[],"2BPFJPV7U":[],"2BNHMKX62":[],"2BPZYFGWR":[],"2BQDFSXQS":[],"2BRBUKY3M":[],"2BR3MRYCG":[],"2BQDQT3TB":[],"2BN175FK1":[],"2BQYZ1KVR":[],"2BPB9TZYZ":[],"2BPUX4QU5":[],"2BQ59ZDWA":[],"2BPCN958V":[]},"config":{"looknfeel":"default"},"info":{}}